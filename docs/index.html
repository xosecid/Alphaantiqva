<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Alpha Antiqva | Catálogo</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;1,400&family=Lato:wght@300;400&display=swap" rel="stylesheet">

  <style>
    :root { --bg:#F0EEE9; --text:#1A1A1A; }
    body { font-family:'Lato',sans-serif; background:var(--bg); color:var(--text); -webkit-font-smoothing:antialiased; margin:0; }
    h1,h3,.descripcion-joya { font-family:'Cormorant Garamond',serif; letter-spacing:2px; margin:0; }

    header { padding-top:3rem; padding-bottom:.5rem; text-align:center; }
    main { max-width:1100px; margin:0 auto; padding:0 16px 40px; }
    nav { display:flex; justify-content:center; gap:18px; padding:20px 0; position:sticky; top:0; background:rgba(240,238,233,0.92); z-index:40; backdrop-filter:blur(6px); }
    .category-tab { position:relative; padding-bottom:6px; cursor:pointer; font-size:12px; text-transform:uppercase; }
    .category-tab.active::after { content:''; position:absolute; left:0; bottom:0; width:100%; height:2px; background:var(--text); }

    #catalog-grid { display:grid; grid-template-columns:repeat(2,1fr); gap:24px; padding:24px 0; }
    @media(min-width:768px){ #catalog-grid { grid-template-columns:repeat(3,1fr); } }

    .item { position:relative; overflow:visible; }
    .meta { margin-top:12px; text-align:center; }

    .carousel { display:flex; overflow-x:auto; scroll-snap-type:x mandatory; -webkit-overflow-scrolling:touch; scrollbar-width:none; gap:0; }
    .carousel::-webkit-scrollbar { display:none; }
    .carousel-item { flex:0 0 100%; scroll-snap-align:start; position:relative; padding-bottom:6px; }
    .carousel-item img { width:100%; aspect-ratio:1/1.1; object-fit:cover; border-radius:6px; cursor:pointer; display:block; user-select:none; }

    /* overlay (description) */
    .desc-overlay {
      position:absolute; inset:0; display:flex; align-items:center; justify-content:center;
      padding:18px; text-align:center; color:white; background:rgba(0,0,0,0.62);
      opacity:0; transition:opacity .22s ease; pointer-events:none; border-radius:6px;
      font-family:'Cormorant Garamond',serif; font-size:15px; font-style:italic; line-height:1.5;
      z-index:100;
    }
    .desc-overlay.active { opacity:1; pointer-events:auto; }

    .desc-overlay .wa-wrap { margin-top:12px; display:flex; justify-content:center; }
    .desc-overlay a.whatsapp-link {
      display:inline-flex; align-items:center; justify-content:center; width:38px; height:38px; border-radius:50%;
      color:white; border:1px solid rgba(255,255,255,0.7); text-decoration:none; background:transparent;
    }
    .desc-overlay a.whatsapp-link:hover { background:rgba(255,255,255,0.08); }

    .zoom-btn {
      position:absolute; top:10px; right:10px; width:36px; height:36px; border-radius:50%;
      background:rgba(240,238,233,0.95); display:flex; align-items:center; justify-content:center;
      cursor:pointer; z-index:110; box-shadow:0 6px 18px rgba(0,0,0,0.08);
    }

    /* modal / zoom viewer */
    #zoom-modal { display:none; position:fixed; inset:0; background:rgba(0,0,0,0.85); z-index:9999; align-items:center; justify-content:center; padding:24px; }
    .modal-frame { max-width:1100px; width:100%; max-height:92vh; background:#fff; border-radius:10px; overflow:hidden; display:flex; flex-direction:column; }
    .modal-header { display:flex; justify-content:space-between; align-items:center; padding:10px 14px; background:var(--bg); border-bottom:1px solid rgba(0,0,0,0.06); }
    .modal-body { display:flex; gap:12px; padding:18px; align-items:center; justify-content:center; flex:1 1 auto; }
    .modal-body .main-wrap { flex:1 1 60%; display:flex; align-items:center; justify-content:center; }
    .modal-body img.main { max-width:100%; max-height:78vh; object-fit:contain; border-radius:6px; display:block; }
    .thumbs { width:220px; max-width:30%; display:flex; gap:8px; flex-wrap:wrap; justify-content:center; align-content:flex-start; }
    .thumbs img { width:72px; height:72px; object-fit:cover; border-radius:6px; cursor:pointer; border:2px solid transparent; box-shadow:0 4px 14px rgba(0,0,0,0.06); }
    .thumbs img.active { border-color:var(--text); }

    @media(max-width:640px){
      .modal-body { flex-direction:column; padding:12px; }
      .thumbs { width:100%; flex-direction:row; justify-content:center; }
      .thumbs img { width:56px; height:56px; }
      .modal-body .main-wrap { width:100%; }
    }

  </style>
</head>
<body>

  <header>
    <h1 class="text-3xl md:text-4xl italic">Alpha Antiqva</h1>
    <p class="text-xs tracking-widest text-gray-500 mt-1">Joyas & relojes antiguos</p>
  </header>

  <nav>
    <button onclick="filterCategory('todo')" class="category-tab active" id="tab-todo">Todo</button>
    <button onclick="filterCategory('anillos')" class="category-tab" id="tab-anillos">Anillos</button>
    <button onclick="filterCategory('pendientes')" class="category-tab" id="tab-pendientes">Pendientes</button>
    <button onclick="filterCategory('broches')" class="category-tab" id="tab-broches">Broches</button>
    <button onclick="filterCategory('collares')" class="category-tab" id="tab-collares">Collares</button>
  </nav>

  <main>
    <div id="catalog-grid">

      <!-- existing items 0..10 (kept) -->

      <!-- 0: Anillo Roseta -->
      <div class="item item-anillos" data-index="0">
        <div class="zoom-btn" onclick="openZoom(0,0)">+</div>
        <div class="carousel" aria-hidden="false">
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771363353/IMG_8184_lrw67a.heic" alt="Anillo Roseta - 1"></div>
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771363354/IMG_8193_nwksub.heic" alt="Anillo Roseta - 2"></div>
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771363352/IMG_8186_ek1a82.heic" alt="Anillo Roseta - 3"></div>
        </div>
        <div class="meta mt-3 text-center"><h3 class="italic uppercase">Anillo Roseta y diamantes 790€</h3></div>
      </div>

      <!-- 1: Pendientes -->
      <div class="item item-pendientes" data-index="1">
        <div class="zoom-btn" onclick="openZoom(1,0)">+</div>
        <div class="carousel" aria-hidden="false">
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771364336/IMG_8011_w7wtrn.heic" alt="Pendientes - 1"></div>
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771364337/IMG_8012_aah1di.heic" alt="Pendientes - 2"></div>
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771364337/IMG_8014_nlqmvx.heic" alt="Pendientes - 3"></div>
        </div>
        <div class="meta mt-3 text-center"><h3 class="italic uppercase">Pendientes flor de plata 275€</h3></div>
      </div>

      <!-- 2: Anillo solitario 390 -->
      <div class="item item-anillos" data-index="2">
        <div class="zoom-btn" onclick="openZoom(2,0)">+</div>
        <div class="carousel" aria-hidden="false">
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771364554/IMG_8204_i9nuxt.heic" alt="Anillo solitario - 1"></div>
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771364554/IMG_8209_ulggca.heic" alt="Anillo solitario - 2"></div>
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771364554/IMG_8207_yha6ap.heic" alt="Anillo solitario - 3"></div>
        </div>
        <div class="meta mt-3 text-center"><h3 class="italic uppercase">Anillo solitario con diamante 390€</h3></div>
      </div>

      <!-- 3: Broche Art Deco -->
      <div class="item item-broches" data-index="3">
        <div class="zoom-btn" onclick="openZoom(3,0)">+</div>
        <div class="carousel" aria-hidden="false">
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771365340/IMG_8001_w9tfm6.heic" alt="Broche - 1"></div>
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771365020/IMG_7998_k4dk5u.heic" alt="Broche - 2"></div>
        </div>
        <div class="meta mt-3 text-center"><h3 class="italic uppercase">Broche Art Deco diamante 290€</h3></div>
      </div>

      <!-- 4: Anillo Art Deco 320 -->
      <div class="item item-anillos" data-index="4">
        <div class="zoom-btn" onclick="openZoom(4,0)">+</div>
        <div class="carousel" aria-hidden="false">
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771365581/IMG_7933_nzuj0q.heic" alt="Anillo Art Deco - 1"></div>
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771365595/IMG_7940_xbfncz.heic" alt="Anillo Art Deco - 2"></div>
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771365593/IMG_7939_yjio2s.heic" alt="Anillo Art Deco - 3"></div>
        </div>
        <div class="meta mt-3 text-center"><h3 class="italic uppercase">Anillo solitario Art Deco 320€</h3></div>
      </div>

      <!-- 5: Collar perlas (nuevo) -->
      <div class="item item-collares" data-index="5">
        <div class="zoom-btn" onclick="openZoom(5,0)">+</div>
        <div class="carousel" aria-hidden="false">
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771366493/IMG_8043_vyzbaz.heic" alt="Collar - 1"></div>
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771366581/IMG_8046_pz9ev7.heic" alt="Collar - 2"></div>
        </div>
        <div class="meta mt-3 text-center"><h3 class="italic uppercase">Collar perlas cierre flor 120€</h3></div>
      </div>

      <!-- 6: Broche de plata 90€ (nuevo) -->
      <div class="item item-broches" data-index="6">
        <div class="zoom-btn" onclick="openZoom(6,0)">+</div>
        <div class="carousel" aria-hidden="false">
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771367532/IMG_7992_y63gas.heic" alt="Broche plata - 1"></div>
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771367532/IMG_7991_q5s9rl.heic" alt="Broche plata - 2"></div>
        </div>
        <div class="meta mt-3 text-center"><h3 class="italic uppercase">Broche de plata 90€</h3></div>
      </div>

      <!-- 7: Anillo flor con zafiros 190€ (nuevo) -->
      <div class="item item-anillos" data-index="7">
        <div class="zoom-btn" onclick="openZoom(7,0)">+</div>
        <div class="carousel" aria-hidden="false">
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771367814/IMG_8222_fsvauc.heic" alt="Anillo flor - 1"></div>
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771367813/IMG_8224_d2sdea.heic" alt="Anillo flor - 2"></div>
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771367814/IMG_8227_acogrt.heic" alt="Anillo flor - 3"></div>
        </div>
        <div class="meta mt-3 text-center"><h3 class="italic uppercase">Anillo flor con zafiros 190€</h3></div>
      </div>

      <!-- 8: Anillo Daisy Art Deco 290€ -->
      <div class="item item-anillos" data-index="8">
        <div class="zoom-btn" onclick="openZoom(8,0)">+</div>
        <div class="carousel" aria-hidden="false">
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771368277/IMG_7868_khab2y.heic" alt="Anillo Daisy - 1"></div>
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771368278/IMG_7873_f6snwy.heic" alt="Anillo Daisy - 2"></div>
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771368280/IMG_7871_nxcciv.heic" alt="Anillo Daisy - 3"></div>
        </div>
        <div class="meta mt-3 text-center"><h3 class="italic uppercase">Anillo Daisy Art Deco 290€</h3></div>
      </div>

      <!-- 9: Collar perlas 75€ -->
      <div class="item item-collares" data-index="9">
        <div class="zoom-btn" onclick="openZoom(9,0)">+</div>
        <div class="carousel" aria-hidden="false">
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771368463/IMG_8053_ecpr33.heic" alt="Collar perlas - 1"></div>
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771368460/IMG_8051_i3s4fj.heic" alt="Collar perlas - 2"></div>
        </div>
        <div class="meta mt-3 text-center"><h3 class="italic uppercase">Collar perlas 75€</h3></div>
      </div>

      <!-- 10: Anillo plata lanzadera 120€ -->
      <div class="item item-anillos" data-index="10">
        <div class="zoom-btn" onclick="openZoom(10,0)">+</div>
        <div class="carousel" aria-hidden="false">
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771368590/IMG_8099_sd4apo.heic" alt="Anillo lanzadera - 1"></div>
        </div>
        <div class="meta mt-3 text-center"><h3 class="italic uppercase">Anillo plata lanzadera 120€</h3></div>
      </div>

      <!-- NEW ADDED PRODUCTS: 11..13 -->

      <!-- 11: Anillo crossover 290€ -->
      <div class="item item-anillos" data-index="11">
        <div class="zoom-btn" onclick="openZoom(11,0)">+</div>
        <div class="carousel" aria-hidden="false">
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771368989/IMG_8215_vcyqi2.heic" alt="Anillo crossover - 1"></div>
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771368988/IMG_8219_vbts1r.heic" alt="Anillo crossover - 2"></div>
        </div>
        <div class="meta mt-3 text-center"><h3 class="italic uppercase">Anillo crossover 290€</h3></div>
      </div>

      <!-- 12: Anillo tresillo diamantes 390€ -->
      <div class="item item-anillos" data-index="12">
        <div class="zoom-btn" onclick="openZoom(12,0)">+</div>
        <div class="carousel" aria-hidden="false">
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771369143/IMG_7893_nmysej.heic" alt="Anillo tresillo - 1"></div>
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771369176/IMG_7894_g7u716.heic" alt="Anillo tresillo - 2"></div>
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771369184/IMG_7902_fhgkh4.heic" alt="Anillo tresillo - 3"></div>
        </div>
        <div class="meta mt-3 text-center"><h3 class="italic uppercase">Anillo tresillo diamantes 390€</h3></div>
      </div>

      <!-- 13: Anillo oro Art Deco (4 imágenes) -->
      <div class="item item-anillos" data-index="13">
        <div class="zoom-btn" onclick="openZoom(13,0)">+</div>
        <div class="carousel" aria-hidden="false">
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771369343/IMG_7987_fgwklq.heic" alt="Anillo oro Art Deco - 1"></div>
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771369301/IMG_7980_it8tyt.heic" alt="Anillo oro Art Deco - 2"></div>
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771369341/IMG_7985_qlzy2k.heic" alt="Anillo oro Art Deco - 3"></div>
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771369303/IMG_7983_pasy4w.heic" alt="Anillo oro Art Deco - 4"></div>
        </div>
        <div class="meta mt-3 text-center"><h3 class="italic uppercase">Anillo oro Art Deco</h3></div>
      </div>

    </div>
  </main>

  <!-- Modal / Zoom -->
  <div id="zoom-modal" aria-hidden="true">
    <div class="modal-frame" role="dialog" aria-modal="true">
      <div class="modal-header">
        <span class="text-xs uppercase tracking-widest text-gray-500">Detalle de pieza</span>
        <div style="display:flex; gap:8px; align-items:center;">
          <div id="prev-btn" class="modal-arrow" style="cursor:pointer;padding:6px 8px;font-size:20px;">&lsaquo;</div>
          <div id="next-btn" class="modal-arrow" style="cursor:pointer;padding:6px 8px;font-size:20px;">&rsaquo;</div>
          <button onclick="closeZoom()" style="font-size:22px; background:none; border:0; cursor:pointer" aria-label="Cerrar">&times;</button>
        </div>
      </div>
      <div class="modal-body">
        <div class="main-wrap">
          <img id="zoom-main-image" class="main" src="" alt="Detalle">
        </div>
        <div class="thumbs" id="zoom-thumbs" aria-hidden="false"></div>
      </div>
    </div>
  </div>

  <script>
    /* ================= DATA (usando f_jpg para compatibilidad) ================= */
    const productsImages = [
      [
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771363353/IMG_8184_lrw67a.heic",
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771363354/IMG_8193_nwksub.heic",
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771363352/IMG_8186_ek1a82.heic"
      ],
      [
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771364336/IMG_8011_w7wtrn.heic",
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771364337/IMG_8012_aah1di.heic",
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771364337/IMG_8014_nlqmvx.heic"
      ],
      [
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771364554/IMG_8204_i9nuxt.heic",
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771364554/IMG_8209_ulggca.heic",
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771364554/IMG_8207_yha6ap.heic"
      ],
      [
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771365340/IMG_8001_w9tfm6.heic",
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771365020/IMG_7998_k4dk5u.heic"
      ],
      [
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771365581/IMG_7933_nzuj0q.heic",
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771365595/IMG_7940_xbfncz.heic",
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771365593/IMG_7939_yjio2s.heic"
      ],
      [
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771366493/IMG_8043_vyzbaz.heic",
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771366581/IMG_8046_pz9ev7.heic"
      ],
      [
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771367532/IMG_7992_y63gas.heic",
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771367532/IMG_7991_q5s9rl.heic"
      ],
      [
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771367814/IMG_8222_fsvauc.heic",
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771367813/IMG_8224_d2sdea.heic",
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771367814/IMG_8227_acogrt.heic"
      ],
      [
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771368277/IMG_7868_khab2y.heic",
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771368278/IMG_7873_f6snwy.heic",
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771368280/IMG_7871_nxcciv.heic"
      ],
      [
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771368463/IMG_8053_ecpr33.heic",
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771368460/IMG_8051_i3s4fj.heic"
      ],
      [
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771368590/IMG_8099_sd4apo.heic"
      ],
      /* newly added */
      [
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771368989/IMG_8215_vcyqi2.heic",
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771368988/IMG_8219_vbts1r.heic"
      ],
      [
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771369143/IMG_7893_nmysej.heic",
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771369176/IMG_7894_g7u716.heic",
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771369184/IMG_7902_fhgkh4.heic"
      ],
      [
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771369343/IMG_7987_fgwklq.heic",
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771369301/IMG_7980_it8tyt.heic",
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771369341/IMG_7985_qlzy2k.heic",
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771369303/IMG_7983_pasy4w.heic"
      ]
    ];

    const productTitles = [
      "Anillo Roseta y diamantes 790€",
      "Pendientes flor de plata 275€",
      "Anillo solitario con diamante 390€",
      "Broche Art Deco diamante 290€",
      "Anillo solitario Art Deco 320€",
      "Collar perlas cierre flor 120€",
      "Broche de plata 90€",
      "Anillo flor con zafiros 190€",
      "Anillo Daisy Art Deco 290€",
      "Collar perlas 75€",
      "Anillo plata lanzadera 120€",
      "Anillo crossover 290€",
      "Anillo tresillo diamantes 390€",
      "Anillo oro Art Deco"
    ];

    const productDescriptions = [
      "Anillo roseta de oro 18 quilates y diamantes",
      "Pendientes flor plata con filo de oro y zafiros blancos",
      "Anillo solitario con diamante y base rayada en platino y oro de 18 quilates",
      "Broche art deco con circulo platino y diamante oro 18ct",
      "Anillo solitario Art Deco con diamante, base de platino y oro 18ct",
      "Collar de perlas naturales doble con cierre de plata",
      "Broche de plata con marcasitas y diseño clásico",
      "Anillo flor con zafiros de 9ct, diseño floral detallado",
      "Anillo Daisy Art Deco con piedra ágata, oro 9ct",
      "Collar perlas pequeñas una vuelta con cierre plata",
      "Anillo lanzadera de plata con marcasitas",
      "Anillo crossover con base platino y oro de 15ct",
      "Anillo tresillo de diamantes con base de platino en oro 18ct",
      "Anillo oro rectangular Art Deco con marcasitas oro 19ct"
    ];

    /* Pon aquí tu número (sin + ni espacios) */
    const YOUR_WHATSAPP_NUMBER = 34695886365;

    function buildWhatsappUrl(number, text) {
      const encoded = encodeURIComponent(text);
      if (number && number !== "YOUR_PHONE_NUMBER") {
        return `https://wa.me/${number}?text=${encoded}`;
      } else {
        return `https://api.whatsapp.com/send?text=${encoded}`;
      }
    }

    /* ============== INIT ============== */
    document.addEventListener('DOMContentLoaded', () => {
      console.log('init: adding overlays and handlers');

      // Stop zoom button clicks from toggling overlays (keep onclick)
      document.querySelectorAll('.zoom-btn').forEach(btn => btn.addEventListener('click', e => e.stopPropagation()));

      // For each product item, add overlays to each carousel-item
      document.querySelectorAll('.item').forEach(item => {
        const productIndex = Number(item.dataset.index ?? -1);
        const carouselItems = item.querySelectorAll('.carousel-item');

        carouselItems.forEach((ci, imgIdx) => {
          // description text for this product
          const desc = productDescriptions[productIndex] || "Joya de colección, acabado a mano.";

          // determine the modal image url corresponding to this carousel image (fallback to img src)
          let modalImgUrl = '';
          if (productsImages[productIndex] && productsImages[productIndex][imgIdx]) {
            modalImgUrl = productsImages[productIndex][imgIdx];
          } else {
            const imgEl = ci.querySelector('img');
            modalImgUrl = imgEl ? imgEl.src.replace('/w_800,q_auto,f_auto/', '/w_1200,q_auto,f_auto/').replace('/f_jpg,w_800,q_auto/', '/f_jpg,w_1200,q_auto/') : '';
          }

          const messageText = `Hola! estoy interesado en esta pieza: ${productTitles[productIndex]}. Imagen: ${modalImgUrl}`;
          const waUrl = buildWhatsappUrl(YOUR_WHATSAPP_NUMBER, messageText);

          // create overlay element
          const overlay = document.createElement('div');
          overlay.className = 'desc-overlay';
          overlay.innerHTML = `<div>
              <div>${desc}</div>
              <div class="wa-wrap">
                <a class="whatsapp-link" href="${waUrl}" target="_blank" rel="noopener" aria-label="Contactar por WhatsApp">
                  <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 32 32" fill="currentColor" aria-hidden="true">
                    <path d="M19.11 17.44c-.29-.14-1.71-.84-1.97-.94-.26-.10-.45-.14-.64.14-.19.29-.74.94-.91 1.13-.17.19-.34.21-.63.07-.29-.14-1.23-.45-2.34-1.43-.86-.77-1.44-1.71-1.61-2-.17-.29-.02-.45.13-.59.13-.13.29-.34.43-.51.14-.17.19-.29.29-.48.10-.19.05-.36-.02-.51-.07-.14-.64-1.54-.88-2.11-.23-.55-.47-.48-.64-.49-.17-.01-.36-.01-.55-.01-.19 0-.51.07-.77.36-.26.29-1.01.99-1.01 2.41 0 1.42 1.03 2.79 1.17 2.98.14.19 2.03 3.1 4.93 4.35.69.30 1.23.48 1.65.61.69.22 1.31.19 1.81.12.55-.08 1.71-.70 1.95-1.38.24-.67.24-1.25.17-1.38-.07-.13-.26-.21-.55-.36z"/>
                    <path d="M16.02 2.67C8.68 2.67 2.67 8.68 2.67 16c0 2.59.74 5.11 2.14 7.27L2 30l6.95-2.73c2.05 1.12 4.37 1.71 6.78 1.71 7.34 0 13.35-6.01 13.35-13.35 0-7.32-6.01-13.35-13.35-13.35zm0 23.7c-2.19 0-4.33-.59-6.18-1.71l-.44-.26-4.12 1.62 1.61-4.01-.29-.41c-1.18-1.79-1.8-3.88-1.8-6.03 0-6.11 4.97-11.09 11.09-11.09 6.11 0 11.09 4.97 11.09 11.09 0 6.11-4.98 11.09-11.09 11.09z"/>
                  </svg>
                </a>
              </div>
            </div>`;

          // append overlay into the carousel item
          ci.appendChild(overlay);

          // toggle overlay when clicking the carousel item (but not clicking whatsapp)
          ci.addEventListener('click', (e) => {
            if (e.target.closest('a.whatsapp-link')) return;
            overlay.classList.toggle('active');
          });

          // clicking overlay closes it (and stops propagation)
          overlay.addEventListener('click', (e) => {
            e.stopPropagation();
            overlay.classList.remove('active');
          });

          // whatsapp click should not close overlay
          const link = overlay.querySelector('a.whatsapp-link');
          if (link) link.addEventListener('click', (e) => e.stopPropagation());
        });
      });

      // modal controls
      document.getElementById('next-btn')?.addEventListener('click', (e) => { e.stopPropagation(); nextImage(); });
      document.getElementById('prev-btn')?.addEventListener('click', (e) => { e.stopPropagation(); prevImage(); });

      // close modal clicking outside frame
      const zoomModal = document.getElementById('zoom-modal');
      if (zoomModal) {
        zoomModal.addEventListener('click', function(e) {
          const frame = this.querySelector('.modal-frame');
          if (!frame) return;
          if (!frame.contains(e.target)) closeZoom();
        });
      }

      // initial filter
      renderInitialState();

      console.log('init: done');
    });

    /* ============== MODAL / ZOOM CODE ============== */
    let currentProduct = 0;
    let currentIndex = 0;
    let keyHandler = null;

    function openZoom(productIndex, imageIndex = 0) {
      const imgs = productsImages[productIndex];
      if (!imgs || imgs.length === 0) { console.warn('openZoom: no images for product', productIndex); return; }
      currentProduct = productIndex;
      currentIndex = imageIndex || 0;
      renderModal();
      document.getElementById('zoom-modal').style.display = 'flex';
      document.body.style.overflow = 'hidden';
      keyHandler = function(e) {
        if (e.key === 'Escape') closeZoom();
        if (e.key === 'ArrowRight') nextImage();
        if (e.key === 'ArrowLeft') prevImage();
      };
      document.addEventListener('keydown', keyHandler);
    }

    function closeZoom() {
      document.getElementById('zoom-modal').style.display = 'none';
      document.body.style.overflow = 'auto';
      document.getElementById('zoom-main-image').src = '';
      document.getElementById('zoom-thumbs').innerHTML = '';
      if (keyHandler) { document.removeEventListener('keydown', keyHandler); keyHandler = null; }
    }

    function renderModal() {
      const imgs = productsImages[currentProduct] || [];
      const main = document.getElementById('zoom-main-image');
      const thumbs = document.getElementById('zoom-thumbs');
      thumbs.innerHTML = '';
      imgs.forEach((src, i) => {
        const t = document.createElement('img');
        t.src = src;
        t.alt = 'Mini ' + (i+1);
        t.addEventListener('click', () => {
          currentIndex = i;
          updateModalImage();
        });
        if (i === currentIndex) t.classList.add('active');
        thumbs.appendChild(t);
      });
      updateModalImage();
    }

    function updateModalImage() {
      const imgs = productsImages[currentProduct] || [];
      const main = document.getElementById('zoom-main-image');
      if (!imgs || !imgs.length) return;
      if (currentIndex < 0) currentIndex = 0;
      if (currentIndex >= imgs.length) currentIndex = imgs.length - 1;
      main.src = imgs[currentIndex];
      document.querySelectorAll('#zoom-thumbs img').forEach((t, i) => t.classList.toggle('active', i === currentIndex));
    }

    function nextImage() {
      const imgs = productsImages[currentProduct] || [];
      if (!imgs.length) return;
      currentIndex = (currentIndex + 1) % imgs.length;
      updateModalImage();
    }
    function prevImage() {
      const imgs = productsImages[currentProduct] || [];
      if (!imgs.length) return;
      currentIndex = (currentIndex - 1 + imgs.length) % imgs.length;
      updateModalImage();
    }

    /* ============== FILTERS ============== */
    function filterCategory(category) {
      document.querySelectorAll('.category-tab').forEach(t => t.classList.remove('active'));
      const tab = document.getElementById('tab-' + category);
      if (tab) tab.classList.add('active');
      document.querySelectorAll('#catalog-grid .item').forEach(item => {
        item.style.display = (category === 'todo' || item.classList.contains('item-' + category)) ? 'block' : 'none';
      });
      document.getElementById('catalog-grid').scrollIntoView({behavior:'smooth'});
    }

    function renderInitialState() { filterCategory('todo'); }

  </script>
</body>
</html>
