<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Alpha Antiqva | Catálogo</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;1,400&family=Lato:wght@300;400&display=swap" rel="stylesheet">

  <style>
    :root { --bg:#F0EEE9; --text:#1A1A1A; }
    body { font-family:'Lato',sans-serif; background:var(--bg); color:var(--text); -webkit-font-smoothing:antialiased; margin:0; }
    h1,h3,.descripcion-joya { font-family:'Cormorant Garamond',serif; letter-spacing:2px; margin:0; }

    header { padding-top:3rem; padding-bottom:.5rem; text-align:center; }
    main { max-width:1100px; margin:0 auto; padding:0 16px 40px; }
    nav { display:flex; justify-content:center; gap:18px; padding:20px 0; position:sticky; top:0; background:rgba(240,238,233,0.92); z-index:40; backdrop-filter:blur(6px); }
    .category-tab { position:relative; padding-bottom:6px; cursor:pointer; font-size:12px; text-transform:uppercase; }
    .category-tab.active::after { content:''; position:absolute; left:0; bottom:0; width:100%; height:2px; background:var(--text); }

    #catalog-grid { display:grid; grid-template-columns:repeat(2,1fr); gap:24px; padding:24px 0; }
    @media(min-width:768px){ #catalog-grid { grid-template-columns:repeat(3,1fr); } }

    .item { position:relative; overflow:visible; }
    .meta { margin-top:12px; text-align:center; }

    .carousel { display:flex; overflow-x:auto; scroll-snap-type:x mandatory; -webkit-overflow-scrolling:touch; scrollbar-width:none; gap:0; }
    .carousel::-webkit-scrollbar { display:none; }
    .carousel-item { flex:0 0 100%; scroll-snap-align:start; position:relative; padding-bottom:6px; }
    .carousel-item img { width:100%; aspect-ratio:1/1.1; object-fit:cover; border-radius:6px; cursor:pointer; display:block; user-select:none; }

    /* overlay (description) */
    .desc-overlay {
      position:absolute; inset:0; display:flex; align-items:center; justify-content:center;
      padding:18px; text-align:center; color:white; background:rgba(0,0,0,0.62);
      opacity:0; transition:opacity .22s ease; pointer-events:none; border-radius:6px;
      font-family:'Cormorant Garamond',serif; font-size:15px; font-style:italic; line-height:1.5;
      z-index:100;
    }
    .desc-overlay.active { opacity:1; pointer-events:auto; }

    .desc-overlay .wa-wrap { margin-top:12px; display:flex; justify-content:center; }
    .desc-overlay a.whatsapp-link {
      display:inline-flex; align-items:center; justify-content:center; width:38px; height:38px; border-radius:50%;
      color:white; border:1px solid rgba(255,255,255,0.7); text-decoration:none; background:transparent;
    }
    .desc-overlay a.whatsapp-link:hover { background:rgba(255,255,255,0.08); }

    .zoom-btn {
      position:absolute; top:10px; right:10px; width:36px; height:36px; border-radius:50%;
      background:rgba(240,238,233,0.95); display:flex; align-items:center; justify-content:center;
      cursor:pointer; z-index:110; box-shadow:0 6px 18px rgba(0,0,0,0.08);
    }

    /* modal / zoom viewer */
    #zoom-modal { display:none; position:fixed; inset:0; background:rgba(0,0,0,0.85); z-index:9999; align-items:center; justify-content:center; padding:24px; }
    .modal-frame { max-width:1100px; width:100%; max-height:92vh; background:#fff; border-radius:10px; overflow:hidden; display:flex; flex-direction:column; }
    .modal-header { display:flex; justify-content:space-between; align-items:center; padding:10px 14px; background:var(--bg); border-bottom:1px solid rgba(0,0,0,0.06); }
    .modal-body { display:flex; gap:12px; padding:18px; align-items:center; justify-content:center; flex:1 1 auto; }
    .modal-body .main-wrap { flex:1 1 60%; display:flex; align-items:center; justify-content:center; }
    .modal-body img.main { max-width:100%; max-height:78vh; object-fit:contain; border-radius:6px; display:block; }
    .thumbs { width:220px; max-width:30%; display:flex; gap:8px; flex-wrap:wrap; justify-content:center; align-content:flex-start; }
    .thumbs img { width:72px; height:72px; object-fit:cover; border-radius:6px; cursor:pointer; border:2px solid transparent; box-shadow:0 4px 14px rgba(0,0,0,0.06); }
    .thumbs img.active { border-color:var(--text); }

    @media(max-width:640px){
      .modal-body { flex-direction:column; padding:12px; }
      .thumbs { width:100%; flex-direction:row; justify-content:center; }
      .thumbs img { width:56px; height:56px; }
      .modal-body .main-wrap { width:100%; }
    }

  </style>
</head>
<body>

  <header>
    <h1 class="text-3xl md:text-4xl italic">Alpha Antiqva</h1>
    <p class="text-xs tracking-widest text-gray-500 mt-1">Joyas & relojes antiguos</p>
  </header>

  <nav>
    <button onclick="filterCategory('todo')" class="category-tab active" id="tab-todo">Todo</button>
    <button onclick="filterCategory('anillos')" class="category-tab" id="tab-anillos">Anillos</button>
    <button onclick="filterCategory('pendientes')" class="category-tab" id="tab-pendientes">Pendientes</button>
    <button onclick="filterCategory('broches')" class="category-tab" id="tab-broches">Broches</button>
    <button onclick="filterCategory('collares')" class="category-tab" id="tab-collares">Collares</button>
  </nav>

  <main>
    <div id="catalog-grid">

      <!-- existing items 0..13 kept (not repeated here for brevity in this comment) -->
      <!-- Make sure the file you paste replaces the previous full file — below are the NEW items appended (indices 14..19) -->

      <!-- 14: Pendientes plata aguamarina 120€ -->
      <div class="item item-pendientes" data-index="14">
        <div class="zoom-btn" onclick="openZoom(14,0)">+</div>
        <div class="carousel" aria-hidden="false">
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771369786/IMG_8024_mkkf8k.heic" alt="Pendientes aguamarina - 1"></div>
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771369782/IMG_8020_yamzfv.heic" alt="Pendientes aguamarina - 2"></div>
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771369784/IMG_8021_koqgon.heic" alt="Pendientes aguamarina - 3"></div>
        </div>
        <div class="meta mt-3 text-center"><h3 class="italic uppercase">Pendientes plata aguamarina 120€</h3></div>
      </div>

      <!-- 15: Anillo oro, diamantes y zafiro 490€ -->
      <div class="item item-anillos" data-index="15">
        <div class="zoom-btn" onclick="openZoom(15,0)">+</div>
        <div class="carousel" aria-hidden="false">
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771369952/IMG_7860_lvcx2l.heic" alt="Anillo zafiro - 1"></div>
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771369963/IMG_7865_isr9kv.heic" alt="Anillo zafiro - 2"></div>
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771369961/IMG_7864_l3houj.heic" alt="Anillo zafiro - 3"></div>
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771369954/IMG_7863_byksy7.heic" alt="Anillo zafiro - 4"></div>
        </div>
        <div class="meta mt-3 text-center"><h3 class="italic uppercase">Anillo oro, diamantes y zafiro 490€</h3></div>
      </div>

      <!-- 16: Anillo Art Deco octogonal 690€ -->
      <div class="item item-anillos" data-index="16">
        <div class="zoom-btn" onclick="openZoom(16,0)">+</div>
        <div class="carousel" aria-hidden="false">
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771370134/IMG_8195_qtkpym.heic" alt="Anillo octogonal - 1"></div>
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771370143/IMG_8200_v4w0oa.heic" alt="Anillo octogonal - 2"></div>
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771370137/IMG_8196_tonw3w.heic" alt="Anillo octogonal - 3"></div>
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771370139/IMG_8198_bv1v1b.heic" alt="Anillo octogonal - 4"></div>
        </div>
        <div class="meta mt-3 text-center"><h3 class="italic uppercase">Anillo Art Deco octogonal 690€</h3></div>
      </div>

      <!-- 17: Anillo crossover con base de platino 350€ -->
      <div class="item item-anillos" data-index="17">
        <div class="zoom-btn" onclick="openZoom(17,0)">+</div>
        <div class="carousel" aria-hidden="false">
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771370307/IMG_7978_lmzzbz.heic" alt="Anillo crossover - 1"></div>
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771370281/IMG_7969_m9oemc.heic" alt="Anillo crossover - 2"></div>
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771370310/IMG_7975_eajwtv.heic" alt="Anillo crossover - 3"></div>
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771370313/IMG_7974_sdma9l.heic" alt="Anillo crossover - 4"></div>
        </div>
        <div class="meta mt-3 text-center"><h3 class="italic uppercase">Anillo crossover con base de platino 350€</h3></div>
      </div>

      <!-- 18: Anillo oro circonitas 180€ -->
      <div class="item item-anillos" data-index="18">
        <div class="zoom-btn" onclick="openZoom(18,0)">+</div>
        <div class="carousel" aria-hidden="false">
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771370492/IMG_7888_n5nuax.heic" alt="Anillo circonitas - 1"></div>
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771370451/IMG_7892_jnwdjf.heic" alt="Anillo circonitas - 2"></div>
        </div>
        <div class="meta mt-3 text-center"><h3 class="italic uppercase">Anillo oro circonitas 180€</h3></div>
      </div>

      <!-- 19: Pendientes espinela granates 120€ -->
      <div class="item item-pendientes" data-index="19">
        <div class="zoom-btn" onclick="openZoom(19,0)">+</div>
        <div class="carousel" aria-hidden="false">
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771370660/IMG_8005_olwfxo.heic" alt="Pendientes granate - 1"></div>
          <div class="carousel-item"><img src="https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_800,q_auto/v1771370664/IMG_8008_lbudho.heic" alt="Pendientes granate - 2"></div>
        </div>
        <div class="meta mt-3 text-center"><h3 class="italic uppercase">Pendientes espinela granates 120€</h3></div>
      </div>

    </div>
  </main>

  <!-- Modal / Zoom -->
  <div id="zoom-modal" aria-hidden="true">
    <div class="modal-frame" role="dialog" aria-modal="true">
      <div class="modal-header">
        <span class="text-xs uppercase tracking-widest text-gray-500">Detalle de pieza</span>
        <div style="display:flex; gap:8px; align-items:center;">
          <div id="prev-btn" class="modal-arrow" style="cursor:pointer;padding:6px 8px;font-size:20px;">&lsaquo;</div>
          <div id="next-btn" class="modal-arrow" style="cursor:pointer;padding:6px 8px;font-size:20px;">&rsaquo;</div>
          <button onclick="closeZoom()" style="font-size:22px; background:none; border:0; cursor:pointer" aria-label="Cerrar">&times;</button>
        </div>
      </div>
      <div class="modal-body">
        <div class="main-wrap">
          <img id="zoom-main-image" class="main" src="" alt="Detalle">
        </div>
        <div class="thumbs" id="zoom-thumbs" aria-hidden="false"></div>
      </div>
    </div>
  </div>

  <script>
    /* ================= DATA (f_jpg,w_1200 for modal; f_jpg,w_800 for grid above) ================= */
    const productsImages = [
      /* indices 0..13 should be kept from your current file (not shown here). Make sure this array in your real file contains the previous entries as well.
         Below are ONLY the new entries for indices 14..19 appended — if you paste this full file, these are included in the array after the earlier items. */

      /* ... previous product image arrays (0..13) must be present here ... */

      /* NEW appended entries (14..19) */
      /* 14 */
      [
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771369786/IMG_8024_mkkf8k.heic",
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771369782/IMG_8020_yamzfv.heic",
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771369784/IMG_8021_koqgon.heic"
      ],
      /* 15 */
      [
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771369952/IMG_7860_lvcx2l.heic",
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771369963/IMG_7865_isr9kv.heic",
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771369961/IMG_7864_l3houj.heic",
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771369954/IMG_7863_byksy7.heic"
      ],
      /* 16 */
      [
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771370134/IMG_8195_qtkpym.heic",
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771370143/IMG_8200_v4w0oa.heic",
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771370137/IMG_8196_tonw3w.heic",
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771370139/IMG_8198_bv1v1b.heic"
      ],
      /* 17 */
      [
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771370307/IMG_7978_lmzzbz.heic",
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771370281/IMG_7969_m9oemc.heic",
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771370310/IMG_7975_eajwtv.heic",
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771370313/IMG_7974_sdma9l.heic"
      ],
      /* 18 */
      [
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771370492/IMG_7888_n5nuax.heic",
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771370451/IMG_7892_jnwdjf.heic"
      ],
      /* 19 */
      [
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771370660/IMG_8005_olwfxo.heic",
        "https://res.cloudinary.com/do7pipzqv/image/upload/f_jpg,w_1200,q_auto/v1771370664/IMG_8008_lbudho.heic"
      ]
    ];

    /* NOTE: If you replaced the previous file with this, ensure the productsImages array also contains indices 0..13 entries before these new ones.
       If you want, puedo produce the full productsImages array including all previous products (0..13) + these new ones in one go — dime si lo prefieres. */

    /* Titles and descriptions: appended accordingly */
    const productTitles = [
      /* previous titles 0..13 must be present here in your full file */,
      "Pendientes plata aguamarina 120€",
      "Anillo oro, diamantes y zafiro 490€",
      "Anillo Art Deco octogonal 690€",
      "Anillo crossover con base de platino 350€",
      "Anillo oro circonitas 180€",
      "Pendientes espinela granates 120€"
    ];

    const productDescriptions = [
      /* previous descriptions 0..13 must be present here in your full file */,
      "Pendientes plata con marcasitas y aguamarina",
      "Anillo zafiro central con diamantes alrededor oro 18ct",
      "Anillo art deco octogonal con diamante central oro 18ct",
      "Anillo crossover con base platino y oro de 18ct",
      "Anillo oro sencillo con circonitas oro 19ct",
      "Pendientes plata con marcasitas y espinela granate"
    ];

    /* Pon aquí tu número (sin + ni espacios) */
    const YOUR_WHATSAPP_NUMBER = 34695886365;

    function buildWhatsappUrl(number, text) {
      const encoded = encodeURIComponent(text);
      if (number && number !== "YOUR_PHONE_NUMBER") {
        return `https://wa.me/${number}?text=${encoded}`;
      } else {
        return `https://api.whatsapp.com/send?text=${encoded}`;
      }
    }

    document.addEventListener('DOMContentLoaded', () => {
      // stop zoom buttons toggling overlays
      document.querySelectorAll('.zoom-btn').forEach(btn => btn.addEventListener('click', e => e.stopPropagation()));

      // Attach overlays to all carousel items (including new ones)
      document.querySelectorAll('.item').forEach(item => {
        const productIndex = Number(item.dataset.index ?? -1);
        const carouselItems = item.querySelectorAll('.carousel-item');

        carouselItems.forEach((ci, imgIdx) => {
          const desc = (productDescriptions[productIndex] !== undefined) ? productDescriptions[productIndex] : "Joya de colección, acabado a mano.";
          // try to get modal URL
          let modalImgUrl = '';
          if (productsImages[productIndex] && productsImages[productIndex][imgIdx]) {
            modalImgUrl = productsImages[productIndex][imgIdx];
          } else {
            const imgEl = ci.querySelector('img');
            modalImgUrl = imgEl ? imgEl.src.replace('/f_jpg,w_800,q_auto/', '/f_jpg,w_1200,q_auto/') : '';
          }

          const messageText = `Hola! estoy interesado en esta pieza: ${productTitles[productIndex] || ''}. Imagen: ${modalImgUrl}`;
          const waUrl = buildWhatsappUrl(YOUR_WHATSAPP_NUMBER, messageText);

          const overlay = document.createElement('div');
          overlay.className = 'desc-overlay';
          overlay.innerHTML = `<div>
              <div>${desc}</div>
              <div class="wa-wrap">
                <a class="whatsapp-link" href="${waUrl}" target="_blank" rel="noopener" aria-label="Contactar por WhatsApp">
                  <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 32 32" fill="currentColor" aria-hidden="true">
                    <path d="M19.11 17.44c-.29-.14-1.71-.84-1.97-.94-.26-.10-.45-.14-.64.14-.19.29-.74.94-.91 1.13-.17.19-.34.21-.63.07-.29-.14-1.23-.45-2.34-1.43-.86-.77-1.44-1.71-1.61-2-.17-.29-.02-.45.13-.59.13-.13.29-.34.43-.51.14-.17.19-.29.29-.48.10-.19.05-.36-.02-.51-.07-.14-.64-1.54-.88-2.11-.23-.55-.47-.48-.64-.49-.17-.01-.36-.01-.55-.01-.19 0-.51.07-.77.36-.26.29-1.01.99-1.01 2.41 0 1.42 1.03 2.79 1.17 2.98.14.19 2.03 3.1 4.93 4.35.69.30 1.23.48 1.65.61.69.22 1.31.19 1.81.12.55-.08 1.71-.70 1.95-1.38.24-.67.24-1.25.17-1.38-.07-.13-.26-.21-.55-.36z"/>
                    <path d="M16.02 2.67C8.68 2.67 2.67 8.68 2.67 16c0 2.59.74 5.11 2.14 7.27L2 30l6.95-2.73c2.05 1.12 4.37 1.71 6.78 1.71 7.34 0 13.35-6.01 13.35-13.35 0-7.32-6.01-13.35-13.35-13.35zm0 23.7c-2.19 0-4.33-.59-6.18-1.71l-.44-.26-4.12 1.62 1.61-4.01-.29-.41c-1.18-1.79-1.8-3.88-1.8-6.03 0-6.11 4.97-11.09 11.09-11.09 6.11 0 11.09 4.97 11.09 11.09 0 6.11-4.98 11.09-11.09 11.09z"/>
                  </svg>
                </a>
              </div>
            </div>`;

          ci.appendChild(overlay);

          ci.addEventListener('click', (e) => {
            if (e.target.closest('a.whatsapp-link')) return;
            overlay.classList.toggle('active');
          });

          overlay.addEventListener('click', (e) => {
            e.stopPropagation();
            overlay.classList.remove('active');
          });

          const link = overlay.querySelector('a.whatsapp-link');
          if (link) link.addEventListener('click', (e) => e.stopPropagation());
        });
      });

      // modal controls
      document.getElementById('next-btn')?.addEventListener('click', (e) => { e.stopPropagation(); nextImage(); });
      document.getElementById('prev-btn')?.addEventListener('click', (e) => { e.stopPropagation(); prevImage(); });

      const zoomModal = document.getElementById('zoom-modal');
      if (zoomModal) {
        zoomModal.addEventListener('click', function(e) {
          const frame = this.querySelector('.modal-frame');
          if (!frame) return;
          if (!frame.contains(e.target)) closeZoom();
        });
      }

      renderInitialState();
    });

    /* Modal / zoom code (same as before) */
    let currentProduct = 0;
    let currentIndex = 0;
    let keyHandler = null;

    function openZoom(productIndex, imageIndex = 0) {
      const imgs = productsImages[productIndex];
      if (!imgs || imgs.length === 0) { console.warn('openZoom: no images for product', productIndex); return; }
      currentProduct = productIndex;
      currentIndex = imageIndex || 0;
      renderModal();
      document.getElementById('zoom-modal').style.display = 'flex';
      document.body.style.overflow = 'hidden';
      keyHandler = function(e) {
        if (e.key === 'Escape') closeZoom();
        if (e.key === 'ArrowRight') nextImage();
        if (e.key === 'ArrowLeft') prevImage();
      };
      document.addEventListener('keydown', keyHandler);
    }

    function closeZoom() {
      document.getElementById('zoom-modal').style.display = 'none';
      document.body.style.overflow = 'auto';
      document.getElementById('zoom-main-image').src = '';
      document.getElementById('zoom-thumbs').innerHTML = '';
      if (keyHandler) { document.removeEventListener('keydown', keyHandler); keyHandler = null; }
    }

    function renderModal() {
      const imgs = productsImages[currentProduct] || [];
      const main = document.getElementById('zoom-main-image');
      const thumbs = document.getElementById('zoom-thumbs');
      thumbs.innerHTML = '';
      imgs.forEach((src, i) => {
        const t = document.createElement('img');
        t.src = src;
        t.alt = 'Mini ' + (i+1);
        t.addEventListener('click', () => {
          currentIndex = i;
          updateModalImage();
        });
        if (i === currentIndex) t.classList.add('active');
        thumbs.appendChild(t);
      });
      updateModalImage();
    }

    function updateModalImage() {
      const imgs = productsImages[currentProduct] || [];
      const main = document.getElementById('zoom-main-image');
      if (!imgs || !imgs.length) return;
      if (currentIndex < 0) currentIndex = 0;
      if (currentIndex >= imgs.length) currentIndex = imgs.length - 1;
      main.src = imgs[currentIndex];
      document.querySelectorAll('#zoom-thumbs img').forEach((t, i) => t.classList.toggle('active', i === currentIndex));
    }

    function nextImage() {
      const imgs = productsImages[currentProduct] || [];
      if (!imgs.length) return;
      currentIndex = (currentIndex + 1) % imgs.length;
      updateModalImage();
    }
    function prevImage() {
      const imgs = productsImages[currentProduct] || [];
      if (!imgs.length) return;
      currentIndex = (currentIndex - 1 + imgs.length) % imgs.length;
      updateModalImage();
    }

    function filterCategory(category) {
      document.querySelectorAll('.category-tab').forEach(t => t.classList.remove('active'));
      const tab = document.getElementById('tab-' + category);
      if (tab) tab.classList.add('active');
      document.querySelectorAll('#catalog-grid .item').forEach(item => {
        item.style.display = (category === 'todo' || item.classList.contains('item-' + category)) ? 'block' : 'none';
      });
      document.getElementById('catalog-grid').scrollIntoView({behavior:'smooth'});
    }

    function renderInitialState() { filterCategory('todo'); }
  </script>
</body>
</html>
